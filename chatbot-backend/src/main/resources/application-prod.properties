# Production Profile - Uses PostgreSQL database

# R2DBC Configuration - PostgreSQL (Production)
spring.r2dbc.url=r2dbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/${DB_NAME:chatbot_db}
spring.r2dbc.username=${DB_USER:chatbot_user}
spring.r2dbc.password=${DB_PASSWORD:chatbot_password}

# R2DBC Connection Pool Configuration (Production optimized)
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=10
spring.r2dbc.pool.max-size=50
spring.r2dbc.pool.max-idle-time=10m
spring.r2dbc.pool.max-acquire-time=PT5S
spring.r2dbc.pool.validation-query=SELECT 1
spring.r2dbc.pool.max-life-time=30m

# Flyway Configuration (Production - PostgreSQL)
spring.flyway.url=jdbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/${DB_NAME:chatbot_db}
spring.flyway.user=${DB_USER:chatbot_user}
spring.flyway.password=${DB_PASSWORD:chatbot_password}
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true

# Production logging (reduced verbosity)
logging.level.app.chatbot.conversation=INFO
logging.level.app.chatbot.responses=INFO
logging.level.org.springframework.r2dbc=WARN
logging.level.io.r2dbc.postgresql=WARN
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# OpenAI Configuration (Production) - Points to LiteLLM proxy
openai.base-url=${OPENAI_RESPONSES_BASE_URL:${OPENAI_BASE_URL:http://litellm:4000/v1}}
openai.api-key=${OPENAI_API_KEY:sk-local-master}
openai.connect-timeout=PT15S
openai.read-timeout=PT5M

# LiteLLM MCP Admin API (Production)
litellm.base-url=${LITELLM_API_BASE_URL:${LITELLM_BASE_URL:http://litellm:4000}}
litellm.admin-token=${LITELLM_ADMIN_TOKEN:${OPENAI_API_KEY:sk-local-master}}
litellm.connect-timeout=PT10S
litellm.read-timeout=PT45S

# Health check configuration for production
management.endpoint.health.show-details=never
management.endpoint.health.show-components=never
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# Security and performance settings
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s
